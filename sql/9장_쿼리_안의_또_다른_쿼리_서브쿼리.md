# 9장 쿼리 안의 또 다른 쿼리: 서브쿼리

## 1. 학습 날짜

- 2021년 7월 29일

## 2. 학습진도

- 9장 쿼리 안의 또 다른 쿼리: 서브쿼리

## 3. 학습내용

### 1) 서브쿼리

- SELECT 문 안에 또 다른 SELECT 문이 있을 때, 안에 포함된 SELECT 문
- 보조쿼리 또는 하위쿼리라고도 함
- 형태적 측면과 의미적 측면
  - 형태적 측면 서브쿼리
    - 메인쿼리에 포함된 독립적인 SELECT 문
      - 메인쿼리: MySQL에서는 외부쿼리라고도 하는 서브쿼리를 포함하는 SELECT 문
    - 소괄호로 둘러싸임
  - 의미적 측면 서브쿼리
    - 서브쿼리에서 반환하는 결과 집합이 메인쿼리에서 보조 용도로 사용
    - 서브쿼리가 메인쿼리의 어느 곳에 위치하느냐에 따라 특정 값을 반환 또는 테이블처럼 사용 또는 조건을 확인하는데 사용
- 서브쿼리는 두 단계 이상 연산해서 결과 집합을 추출해야 하는 경우에 필요!

- 서브쿼리의 유형 - 메인쿼리에서 위치 또는 연관성에 따라 구분
  - 위치에 따른 구분
    - Scalar 서브쿼리
      - SELECT 절에 이쓴 서브쿼리
    - 파생(Derived) 테이블
      - FROM 절에 있는 서브쿼리
    - WHERE 절의 서브쿼리
  - 연관성에 따른 구분
    - 연관성 있는 서브쿼리
      - 메인쿼리와 서브쿼리를 조인하는 경우
    - 연관성이 없는 서브쿼리
      - 메인쿼리와 서브쿼리를 조인하지 않는 경우

### 2) SELECT와 FROM 절의 서브쿼리

- Scalar 서브쿼리

  - 메인쿼리의 SELECT 절에 오는 서브쿼리
  - 단일 값을 반환

  ```SQL
  SELECT 컬럼1, 컬럼2,
      (   -- Scalar 서브쿼리
          SELECT ...
          FROM ...
          WHERE ...
      ) [AS] 별칭1
  FROM ...
  WHERE ...;
  ```

- 파생 테이블

  - 메인쿼리의 FROM 절에 사용되어 하나의 테이블 역할을 함
  - 주의 사항
    - 별칭 반드시 명시
    - 서브쿼리의 SELECT 절에 명시한 컬럼만 메인쿼리에서 참조할 수 있으며, 컬럼에 별칭을 사용하면 별칭으로 참조함
    - 메인쿼리의 FROM 절에는 1개 이상의 파생 테이블을 사용할 수 있음

  ```SQL
  SELECT 컬럼1, 컬럼2,
  FROM 테이블1 [AS] 별칭,
      (
          SELECT ...
          FROM ...
          WHERE ...
      ) [AS] 별칭2
  WHERE ...;

  SELECT 컬럼1, 컬럼2,
      (
          SELECT ...
          FROM ...
          WHERE ...
      ) [AS] 별칭1
  FROM ...
  WHERE ...;
  ```

## 4. 새롭게 알게된 사실(신선했던 것, 유용했던 점)

## 5. 학습 리뷰

- 구분들에서 `;`이 빠졌습니다.
