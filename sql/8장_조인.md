# 8장 테이블끼리 관계 맺기: 조인

## 1. 학습 날짜

- 2021년 7월 28일

## 2. 학습진도

- 8장 테이블끼리 관계 맺기: 조인

## 3. 학습내용

### 1) 조인이란

- 조인(Join) : SQL로 2개 이상의 테이블을 연결해 조회하는 것

1. 조인의 작동 방식

   - 조인 컬럼: 연결 대상인 테이블에서 같은 값을 가진 컬럼

   - 조인은 대상 테이블에서 컬럼 값이 같은 건을 가져오는 것

2. 조인의 특징

   - 조인에 참여하는 테이블은 같은 값을 가진 조인 컬럼이 존재

     - 조인 컬럼의 이름이 같으면 유추 수월

   - 2개 이상의 테이블을 조인 가능

     - 기본적으로 2개의 테이블을 대상으로 하지만, 설계에 따라 여러 테이블을 대상으로 조인할 수 있다.

   - 조인할 때 테이블에 대한 별칭을 사용

   - 조인 시 조인 조건이 필요

3. ERD로 테이블의 연결 관계 파악하기

   - ERD(Entity Relationship Diagram) : 테이블이 많아 어떤 테이블과 조인 컬럼이 잇는지 파악하기 쉽지 않을때, 테이블 간의 연결 관계를 다이어그램으로 도식화한 것

   - `실선` : 조인 컬럼이 모두 `기본키 컬럼`이라는 뜻

   - `삼지창 모양` : 부모-자식(일대다, 다대다, 다대일) 관계를 표현하기 위해 사용

   - `외래 키` : 테이블 간 부모-자식 관계를 설정할 때 사용하는 제약조건

### 2) 조인 컬럼 값이 같은 건 조회하기: 내부 조인

1. INNER JOIN과 ON 절로 내부 조인하기

   ```sql
   SELECT ...
   FROM 테이블1 [AS] 별칭1 -- 기본적으로 조인에 기준이 되는 테이블
   [INNER] JOIN 테이블2 [AS] 별칭2
   ON 별칭1.컬럼1 = 별칭2.컬럼2 -- 조인 조건 기술
   AND ...
   WHERE ...;
   ```

2. FROM과 WHERE 절로 내부 조인하기

   ```sql
   SELECT ...
   FROM 테이블1 [AS] 별칭1,
        테이블2 [AS] 별칭2
   WHERE 별칭1.컬럼1 = 별칭2.컬럼2 -- 조인 조건 기술
   AND ...;
   ```

   - 일관성 측면에서 첫 번째 방법을 사용하는 것이 좀더 나음

3. 조인 컬럼 값이 같지 않은 건도 조회하기: 외부 조인

4. 외부 조인이란

   - 외부 조인(Outer Join) : 기본으로 조인 컬럼의 값이 같지 않은 ㄱ너이 존재하면 이 건까지 함께 조회

5. LEFT 조인

   ```sql
   SELECT ...
   FROM 테이블1 [AS] 별칭1 -- LEFT 조인에 기준이 되는 테이블
   LEFT [OUTER] JOIN 테이블2 [AS] 별칭2
   ON 별칭1.컬럼1 = 별칭2.컬럼2 -- 조인 조건 기술
   AND ...
   WHERE ...;
   ```

6. RIGHT 조인

   ```sql
   SELECT ...
   FROM 테이블1 [AS] 별칭1
   RIGHT [OUTER] JOIN 테이블2 [AS] 별칭2 -- RIGHT 조인에 기준이 되는 테이블
   ON 별칭1.컬럼1 = 별칭2.컬럼2 -- 조인 조건 기술
   AND ...
   WHERE ...;
   ```

### 4) 조인 조건 없이 조인하기: 기타 조인

1. 자연 조인(Natural Join)

   - 내부 및 외부 조인과 조인 구문만 조금 다름

   - 특이한 점은 조인 조건을 기술하지 않음

   - 이름과 데이터 타입이 같은 컬럼이 반드시 있어야 함

   - 내부 조인이나 외부 조인 둘다 가능

   - SELECT 절에 \*을 명시햇을 때, 공통의 조인 컬럼은 1번만 조회

   ```sql
   SELECT ...
   FROM 테이블1 [AS] 별칭1
   NATURAL [INNER]{LEFT|RIGHT} [OUTER]] JOIN 테이블2
   ```

2. 카티전 곱

   - 카티전 곱(Cartesian Product) : 조인 조건이 없는 조인

   - 조인 조건은 내부적으로 같은 이름의컬럼으로 조인 조건을 생성해 조인을 수행하지만, 카티전 곱은 조인 조건이 정말 없음

   - 카티전 곱으로 조인은 INNER JOIN 구문에서 ON 또는 WHERE 절에 조인 조건을 기수랗지 않으면 카티전 곱을 수행

   - 조인 조건이 없어 각 테이블 데이터의 모든 조합을 가져와 사용하는 경우가 많이 않음

   - SQL 표준에서는 크로스 조인(Cross Join)이라고도 하며, INNER JOIN 대신 `CROSS JOIN` 구문을 사용하여 ON 절을 붙일 수 없음
     - MYSQL에서 CROSS JOIN은 INNER JOIN과 같아 ON 절을 사용할 수 있음

### 5) 조인 없이 테이블 연결해 조인하기: UNION 절

- UNION 절 : 조인을 하지 않고 2개 이상의 테이블에서 데이터를 조회하는 방법

  ```sql
  SELECT ...
  UNION [DISTINCT|ALL]
  SELECT ...
  [UNION [DISTINCT|ALL]]
  ```

  - `UNION DISTINCT`
    - 각 SELECT 문의 결과 집합에서 `중복을 제거하고 데이터를 조회`
    - DISTINCT는 기본값이라 생략 가능
  - `UNION ALL`
    - 각 SLECT 문의 결과 집합에서 `중복을 포함한 모든 데이터를 조회`

## 4. 새롭게 알게된 사실(신선했던 것, 유용했던 점)

- 조인이 정말 어려운 부분이라고 생각했는데, 많이 이해가 되어 좋았습니다.

## 5. 학습 리뷰

- 327 페이지 구문 8-6에서 3번째 줄 대괄호 오타인가요?
- 330 페이지 마지막 문단 오타가 있습니다. (오류가 났ㅅ ㅂ니다.)
